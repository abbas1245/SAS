<!DOCTYPE html>
<html>
<head>
  <meta charset='utf-8'>
  <title>Class Attendance Report</title>
  <%= wicked_pdf_stylesheet_link_tag "pdf" %>
</head>
<body>
  <div class="container">
    <header>
      <h1>Class Attendance Report</h1>
      <div class="class-info">
        <p><strong>Class:</strong> <%= @class_standard.display_name %></p>
        <p><strong>Total Students:</strong> <%= @students.count %></p>
        <p><strong>Generated On:</strong> <%= Time.current.strftime("%B %d, %Y") %></p>
      </div>
    </header>

    <section class="class-stats">
      <h2>Class Statistics</h2>
      <div class="stats-grid">
        <div class="stat-box">
          <h3>Total Students</h3>
          <p class="stat-value"><%= @class_stats[:total_students] %></p>
        </div>
        <div class="stat-box">
          <h3>Total Classes</h3>
          <p class="stat-value"><%= @class_stats[:total_classes] %></p>
        </div>
        <div class="stat-box">
          <h3>Average Attendance</h3>
          <p class="stat-value"><%= number_to_percentage(@class_stats[:average_attendance], precision: 1) %></p>
        </div>
        <div class="stat-box">
          <h3>Students with Good Attendance</h3>
          <p class="stat-value"><%= @class_stats[:students_with_good_attendance] %></p>
        </div>
      </div>
    </section>

    <section class="attendance-table">
      <h2>Student Attendance Details</h2>
      <table>
        <thead>
          <tr>
            <th>Student Name</th>
            <th>Roll Number</th>
            <th>Total Classes</th>
            <th>Present</th>
            <th>Absent</th>
            <th>Late</th>
            <th>Attendance %</th>
            <th>Status</th>
          </tr>
        </thead>
        <tbody>
          <% @attendance_stats.each do |stat| %>
            <tr>
              <td><%= stat[:student].full_name %></td>
              <td><%= stat[:student].roll_number %></td>
              <td class="text-center"><%= stat[:total_classes] %></td>
              <td class="text-center"><%= stat[:present_classes] %></td>
              <td class="text-center"><%= stat[:absent_classes] %></td>
              <td class="text-center"><%= stat[:late_classes] %></td>
              <td class="text-center"><%= number_to_percentage(stat[:attendance_percentage], precision: 1) %></td>
              <td class="text-center"><%= stat[:status].titleize %></td>
            </tr>
          <% end %>
        </tbody>
      </table>
    </section>

    <footer>
      <p>Generated by <%= current_user.full_name %> on <%= Time.current.strftime("%B %d, %Y at %I:%M %p") %></p>
    </footer>
  </div>
</body>
</html> 